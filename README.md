# üéπ MusicNetwork v1.0: AI Solo Piano Generator

**MusicNetwork** ‚Äî —ç—Ç–æ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–ª—å–Ω—ã—Ö –ø–∞—Ä—Ç–∏–π –Ω–∞ —Ñ–æ—Ä—Ç–µ–ø–∏–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä: –æ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—ã—Ä—ã—Ö MIDI-–¥–∞–Ω–Ω—ã—Ö –¥–æ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∞—É–¥–∏–æ —Å –Ω–∞–ª–æ–∂–µ–Ω–∏–µ–º —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.

> **–°—Ç–∞—Ç—É—Å:** –í–µ—Ä—Å–∏—è v1.0 (Piano Solo). –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–≤—è–∑–∫–µ Linear Encoder + LSTM Decoder.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **Text-to-MIDI**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º—É–∑—ã–∫–∏ –ø–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –æ–ø–∏—Å–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Jazz piano with fast rhythm").
*   **MIDI —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ **REMI** (—á–µ—Ä–µ–∑ `miditok`) –¥–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏.
*   **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∏–Ω—Ç–µ–∑**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å **FluidSynth** –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è MIDI –≤ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∞—É–¥–∏–æ (MP3).
*   **Post-processing**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ —Ä–µ–≤–µ—Ä–±–µ—Ä–∞—Ü–∏–∏ (Reverb) —á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫—É `pedalboard` –¥–ª—è –ø—Ä–∏–¥–∞–Ω–∏—è "–æ–±—ä–µ–º–∞" –∑–≤—É—á–∞–Ω–∏—é.
*   **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π UI**: –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ **Gradio** —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.

**üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ Gradio –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞**
![img.png](data/git/img.png)


**üîä –ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏**
<br>**–ü—Ä–æ–º–ø—Ç: "–ë–∞—Ö"**
[data/git/prokofiev.mp3](https://github.com/treketerer/MusicNetwork/blob/main/data/git/Bach.mp3)
<br>**–ü—Ä–æ–º–ø—Ç: "–ü—Ä–æ–∫–æ—Ñ—å–µ–≤"**
[data/git/Bach.mp3](https://github.com/treketerer/MusicNetwork/blob/main/data/git/prokofiev.mp3)

---


## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–º—É –ø—Ä–∏–Ω—Ü–∏–ø—É:

1.  **Encoder (Linear)**: –ü—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –≤ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–ª—É–∂–∏—Ç "–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º" –¥–ª—è –≤—Å–µ–π –±—É–¥—É—â–µ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏.
2.  **Decoder (LSTM)**: 
    *   3-—Å–ª–æ–π–Ω–∞—è LSTM-—Å–µ—Ç—å.
    *   –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç —ç–Ω–∫–æ–¥–µ—Ä–∞ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å MIDI-—Ç–æ–∫–µ–Ω–æ–≤.
    *   –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º—É–∑—ã–∫—É –ø–æ—à–∞–≥–æ–≤–æ, –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–µ–π –Ω–æ—Ç—ã, –ø–∞—É–∑—ã –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≥—Ä–æ–º–∫–æ—Å—Ç–∏.

---

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **–Ø–∑—ã–∫**: Python 3.10+
*   **Deep Learning**: PyTorch
*   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º—É–∑—ã–∫–∏**: `miditok`, `symusic`
*   **–ê—É–¥–∏–æ-–¥–≤–∏–∂–æ–∫**: FluidSynth, `midi2audio`, `pedalboard`
*   **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: Gradio
---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1. –°–∏—Å—Ç–µ–º–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–≤—É–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å **FluidSynth**:
*   **Windows**: –°–∫–∞—á–∞—Ç—å [–±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã](https://www.fluidsynth.org/) –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—É—Ç—å –∫ –Ω–∏–º –≤ —Å–∏—Å—Ç–µ–º–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PATH`.
*   **Linux**: `sudo apt-get install fluidsynth`

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫ Python
–í releases –ª–µ–∂–∏—Ç portable –≤–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞ —Å —É–∂–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–Ω—ã–º venv –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏.
–£—Å—Ç–∞–Ω–æ–≤–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –º–æ–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—É—Å–∫ **install.bat** —Ñ–∞–π–ª–∞ –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏–ª–∏ –∂–µ —á–µ—Ä–µ–∑
<br>```".venv\Scripts\python.exe" -m pip install -r "requirements.txt"```
<br>–∏–ª–∏ –∂–µ
<br>```pip install -r "requirements.txt"```

–ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —á–µ—Ä–µ–∑ **start.bat** –∏–ª–∏ –≤—Ä—É—á–Ω—É—é:
<br>```".venv\Scripts\python.exe" -m main.py```
<br>–∏–ª–∏ –∂–µ
<br>```python main.py```


---

### üìà –û–±—É—á–µ–Ω–∏–µ
–ú–æ–¥–µ–ª—å –±—ã–ª–∞ –æ–±—É—á–µ–Ω–∞ –Ω–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ IterableDataset. –û–±—É—á–∞–ª–∞—Å—å –Ω–∞ 220+ —Ç—ã—Å—è—á–∞—Ö midi —Ñ–∞–π–ª–æ–≤ –∏–∑ [MAESTRO MIDI dataset]("https://magenta.tensorflow.org/datasets/maestro").
* **Loss Function**: CrossEntropyLoss.
* **Optimizer**: Adam (LR: 0.0005).
* **Batch Size**: 192.
* **Clipping**: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ (max_norm=1.0) –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ LSTM.
* **Final Loss**: –Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª–∏ Loss –¥–æ—Å—Ç–∏–≥ 1.4. –î–∞–ª—å—à–µ –æ–±—É—á–µ–Ω–∏–µ –æ—á–µ–Ω—å —Å–∏–ª—å–Ω–æ –∑–∞–º–µ–¥–ª–∏–ª–æ—Å—å.

–õ–æ–≥–∏ –∏ —á–µ–∫–ø–æ–∏–Ω—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏ –≤ –ø–∞–ø–∫—É ./models/.

### üèó –ü–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è (v2.0)
–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤–µ–¥–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –º—É–ª—å—Ç–∏-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:
* Conductor-Follower Architecture: –û—Ç–¥–µ–ª—å–Ω–∞—è "–¥–∏—Ä–∏–∂–∏—Ä—É—é—â–∞—è" –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–∫—Ç–æ–≤.
* Multi-track: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–∏–π –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.<img width="1029" height="85" alt="image" src="https://github.com/user-attachments/assets/341a0ac7-b709-461a-bc22-d1868bbc281d" />
